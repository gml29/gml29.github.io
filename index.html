<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lua Obfuscator</title>
  <style>
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Segoe UI',Tahoma,Verdana,sans-serif;height:100vh;background:#121212;color:#fff;display:flex;align-items:center;justify-content:center;}
    :root{--red:#ff0040;--white:#ffffff;}
    form{width:420px;margin-top:6rem;}
    .card{background:#1a1a1a;border:2px solid var(--red);border-radius:12px;padding:1.8rem;box-shadow:0 0 15px var(--red);}
    .card-header h3{text-align:center;color:var(--white);margin-bottom:1rem;}
    .filescript input[type="file"]{display:none;}
    .filescript label{background:#1a1a1a;color:#fff;border:2px solid var(--red);border-radius:6px;padding:.8rem;display:block;text-align:center;margin-bottom:1rem;cursor:pointer;}
    #num-of-files{text-align:center;font-size:.85rem;color:#ccc;}
    .inputBox{position:relative;margin-top:1.2rem;margin-bottom:1.2rem;}
    .inputBox input{width:100%;padding:1rem;background:#000;border:2px solid var(--red);border-radius:6px;color:#fff;}
    .inputBox span{position:absolute;left:14px;top:50%;transform:translateY(-50%);color:#aaa;transition:.2s;font-size:.9rem;pointer-events:none;}
    .inputBox input:focus~span,.inputBox input:not(:placeholder-shown)~span{top:0;font-size:.7rem;background:#1a1a1a;padding:0 4px;color:#fff;}
    button{width:100%;padding:1rem;margin-top:.9rem;border:none;border-radius:8px;font-weight:bold;color:#fff;cursor:pointer;}
    #obfuscate{background:var(--red);}
  </style>
</head>
<body>

<form id="form">
  <div class="card">
    <div class="card-header"><h3>Encrypt Lua</h3></div>
    <div class="filescript">
      <input type="file" id="file" accept=".lua,.txt"><label for="file">Select Script</label>
      <div id="num-of-files">No File Choosen</div>
    </div>
    <div class="inputBox">
      <input type="text" id="key" required placeholder=" ">
      <span>Encrypt Key</span>
    </div>
    <button type="submit" id="obfuscate">Encrypt / Obfuscate</button>
  </div>
</form>

<script>
let realKey="",leng=128;const abc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
let abcTab=[...abc],ran1="",ran2="",ran3="",ran4="",ran5="",ran6="";
for(let i=0;i<leng;i++){ran1+=abcTab[Math.floor(Math.random()*abcTab.length)];
ran2+=abcTab[Math.floor(Math.random()*abcTab.length)];
ran3+=abcTab[Math.floor(Math.random()*abcTab.length)];
ran4+=abcTab[Math.floor(Math.random()*abcTab.length)];
ran5+=abcTab[Math.floor(Math.random()*abcTab.length)];
ran6+=abcTab[Math.floor(Math.random()*abcTab.length)];}
const xorE=(sc,key)=>{let t=[],k=0;for(let i=0;i<sc.length;i++){let v=sc.charCodeAt(i)+key.charCodeAt(k);k=(k+1)%key.length;t.push(v);}return t;}

let tab1=[],tab2=[],tab3=[],tab4=[],tab5=[],tab6=[];
for(let i=0;i<leng;i++){tab1[i]=abcTab[Math.floor(Math.random()*abcTab.length)].charCodeAt(0);
tab2[i]=abcTab[Math.floor(Math.random()*abcTab.length)].charCodeAt(0);
tab3[i]=abcTab[Math.floor(Math.random()*abcTab.length)].charCodeAt(0);
tab4[i]=abcTab[Math.floor(Math.random()*abcTab.length)].charCodeAt(0);
tab5[i]=abcTab[Math.floor(Math.random()*abcTab.length)].charCodeAt(0);
tab6[i]=abcTab[Math.floor(Math.random()*abcTab.length)].charCodeAt(0);}
tab1=tab1.join();tab2=tab2.join();tab3=tab3.join();tab4=tab4.join();tab5=tab5.join();tab6=tab6.join();

const alibi=(a,b,c,t)=>`local __s=string local __t=table local __m=math local __p=pairs local __l=load local __pr=print;_ENV={string=__s,table=__t,math=__m,pairs=__p,load=__l,print=__pr};${a}="${b}";${b}="${a}";${c}={${t}};function xor(t)local c=\"\" for i=1,#${b} do local byte=string.byte(${b},i);local q=string.byte(${a},(i-1)%#${a}+1);c=c..string.char(bit.bxor(byte,q));end return c end;bit={bxor=function(a,b)local r,m=0,1;while a>0 and b>0 do local aa,bb=a%2,b%2;r=r+m*((aa+bb)%2);m=m*2;a=math.floor(a/2);b=math.floor(b/2) end;if a>0 then r=r+m*a end;if b>0 then r=r+m*b end;return r end};xor(${c})${ran1}z="Encrypt By Gml";`;

const decX=(tbl)=>{let s=ran3,kl=ran4,l=ran1,v=ran2,h=ran5;return`${s}={${tbl.join()}};${kl}=0;${h}='';for ${l},${v} in pairs(${s}) do ${kl}=${kl}+1;${h}=${h}.._ENV["\\\\115\\\\116\\\\114\\\\105\\\\110\\\\103"]["\\\\99\\\\104\\\\97\\\\114"](${v}-_ENV["\\\\115\\\\116\\\\114\\\\105\\\\110\\\\103"]["\\\\98\\\\121\\\\116\\\\101"]("${realKey}",${kl}));if ${kl}==#("${realKey}") then ${kl}=0;end end;if ${ran1}z=="\\\\69\\\\110\\\\99\\\\114\\\\121\\\\112\\\\116\\\\32\\\\66\\\\121\\\\32\\\\89\\\\97\\\\115\\\\117" then _ENV["\\\\108\\\\111\\\\97\\\\100"](${h})() else print("Error") end;`;}

document.getElementById("file").addEventListener("change",e=>{
 let f=e.target.files[0];
 document.getElementById("num-of-files").innerText=(f&&(f.name.endsWith('.lua')||f.name.endsWith('.txt')))?`${f.name} (${(f.size/1024).toFixed(2)}Kb)`:"Please upload only lua file or txt file!";
});

document.getElementById("form").addEventListener("submit",(e)=>{
 e.preventDefault();
 let file=document.getElementById("file").files[0];
 if(!file)return alert("upload first.");
 let key=document.getElementById("key").value;
 realKey="";for(let i=0;i<key.length;i++){realKey+="\\"+key.charCodeAt(i);}
 let r=new FileReader();
 r.onload=()=>{const sc=r.result;
   const t=`local key=[[${key}]];${ran1}z="Encrypt By Gml";${ran2}=${ran1};${ran3}=${ran2};${ran4}=${ran3};${ran5}=${ran4};${ran6}=${ran5};`;
   const out=t+alibi(ran1,ran2,ran3,tab1)+alibi(ran4,ran2,ran5,tab2)+alibi(ran6,ran3,ran1,tab3)+decX(xorE(sc,key))+alibi(ran2,ran4,ran6,tab4)+alibi(ran1,ran4,ran5,tab5)+alibi(ran2,ran1,ran3,tab6);
   let blob=new Blob([out],{type:'octet-stream'}),url=URL.createObjectURL(blob);
   let a=document.createElement('a');a.href=url;a.download='Encrypted_'+file.name;a.click();URL.revokeObjectURL(url);
 }
 r.readAsText(file);
});
</script>
</body>
</html>
